<tool id="csv2xlsx" name="CSV2XLSX" version="@TOOL_VERSION@+galaxy@VERSION_SUFFIX@" profile="21.05">
    <description>Script to convert Beacon v2 Models to XLSX</description>
    <macros>
        <import>macros.xml</import>
    </macros>
    <expand macro="xrefs"/>
    <expand macro="requirements"/>
    <command detect_errors="exit_code"><![CDATA[   
        #import re
        #set $names = []
        #set $x=1
        #for $x, $csv in enumerate($csvs):
            #set $name_base = re.sub('[^\w\-_\.]', '_', $csv.element_identifier)
            #set $name = $name_base
            #silent $names.append( $name )
            ln -s '$csv' ${name}  &&
        #end for
        csv2xlsx
            #for $name in $names:
                ${name}
            #end for
            -o Beacon-v2-Models_template.xlsx
    ]]></command>
    <inputs>
        <param name="csvs" type="data" multiple="true" format="csv" label="CSV files" help="" />
    </inputs>
    <outputs>
        <data name="Beacon_v2_Models_template" format="xlsx" label="${tool.name} on ${on_string}: Beacon-v2-Models_template file" from_work_dir="Beacon-v2-Models_template.xlsx" />
    </outputs>
    <tests>
        <test expect_num_outputs="1">
            <param name="csvs" ftype="csv" value="analyses.csv,genomicVariations.csv,runs.csv,datasets.csv,biosamples.csv,individuals.csv,cohorts.csv" />
            <output name="Beacon_v2_Models_template" file="Beacon-v2-Models_template.xlsx" compare="sim_size">
                <assert_contents><has_size value="12000" delta="1000" /></assert_contents>
            </output>
        </test>
    </tests>
    <help><![CDATA[
         Script to convert Beacon v2 Models to XLSX
    ]]></help>
    <expand macro="citations" />
</tool>
