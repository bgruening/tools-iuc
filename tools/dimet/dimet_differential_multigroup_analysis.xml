<tool id="dimet_@EXECUTABLE@" name="dimet_@EXECUTABLE@" version="@TOOL_VERSION@+galaxy@VERSION_SUFFIX@" profile="20.05">
    <description>
        DIMet is a bioinformatics pipeline for differential analysis of isotopic targeted labeling data.
    </description>
    <macros>
        <token name="@EXECUTABLE@">differential_multigroup_analysis</token>
        <import>macros.xml</import>
    </macros>
    <expand macro="requirements"/>
    <command detect_errors="exit_code"><![CDATA[
    #import json
    #import re

    mkdir -p '${report.extra_files_path}'/output/${suffix}-multi_group_comparison/tables &&
    mkdir -p '${report.extra_files_path}'/output/${suffix}-multi_group_comparison/figures &&
    mkdir -p '${report.extra_files_path}'/raw &&
    mkdir -p '${report.extra_files_path}'/processed &&
    cp -R '$__tool_directory__/config' '${report.extra_files_path}'/config &&

    #set $statistical_test  = {}
    #set $impute_values  = {}
    #set $datatypes_avail = list()

    #if str( $data_input.data_input_selector ) == "abundance":
        #if $data_input.abundance_file:
            cp '$data_input.abundance_file' '${report.extra_files_path}'/raw/abundance.csv &&
            #silent $statistical_test['abundances']=str($data_input.abundance_stat_test)
            #silent $impute_values['abundances']=re.sub('"', '', "min")
            $datatypes_avail.append(re.sub('"', '', "abundances"))
        #end if
    #elif str( $data_input.data_input_selector ) == "mean_enrichment":
        #if $data_input.me_or_frac_contrib_file:
            cp '$data_input.me_or_frac_contrib_file' '${report.extra_files_path}'/raw/me_or_frac_contrib.csv &&
            #silent $statistical_test['mean_enrichment']=str($data_input.meanE_or_fracContrib_stat_test)
            #silent $impute_values['mean_enrichment']=re.sub('"', '', "min")
            $datatypes_avail.append(re.sub('"', '', "mean_enrichment"))
        #end if
    #elif str( $data_input.data_input_selector ) == "isotop_prop":
        #if $data_input.isotop_prop_file:
            cp '$data_input.isotop_prop_file' '${report.extra_files_path}'/raw/isotop_prop.csv &&
            #silent $statistical_test['isotopologue_proportions']=str($data_input.isotopologue_prop_stat_test)
            #silent $impute_values['isotopologue_proportions']=re.sub('"', '', "min")
            $datatypes_avail.append(re.sub('"', '', "isotopologue_proportions"))
        #end if
    #else
        #if $data_input.isotop_abs_file:
            cp '$data_input.isotop_abs_file' '${report.extra_files_path}'/raw/isotop_abs.csv &&
            #silent $statistical_test['isotopologues']=str($data_input.isotopologue_abs_stat_test)
            #silent $impute_values['isotopologues']=re.sub('"', '', "min")
            $datatypes_avail.append(re.sub('"', '', "isotopologues"))
        #end if
    #end if


    ####if $abundance_file:
    ###    cp '$abundance_file' '${report.extra_files_path}'/raw/abundance.csv &&
    ###    #silent $statistical_test['abundances']=str($data_input.abundance_stat_test)
    ###    #silent $impute_values['abundances']=re.sub('"', '', "min")
    ###    $datatypes_avail.append(re.sub('"', '', "abundances"))
    ####end if
    ####if $me_or_frac_contrib_file:
    ###    cp '$me_or_frac_contrib_file' '${report.extra_files_path}'/raw/me_or_frac_contrib.csv &&
    ###    #silent $statistical_test['mean_enrichment']=str($data_input.meanE_or_fracContrib_stat_test)
    ###    #silent $impute_values['mean_enrichment']=re.sub('"', '', "min")
    ###    $datatypes_avail.append(re.sub('"', '', "mean_enrichment"))
    ####end if
    ####if $isotop_abs_file:
    ###    cp '$isotop_abs_file' '${report.extra_files_path}'/raw/isotop_abs.csv &&
    ###    #silent $statistical_test['isotopologues']=str($data_input.isotopologue_abs_stat_test)
    ###    #silent $impute_values['isotopologues']=re.sub('"', '', "min")
    ###    $datatypes_avail.append(re.sub('"', '', "isotopologues"))
    ####end if
    ####if $isotop_prop_file:
    ###    cp '$isotop_prop_file' '${report.extra_files_path}'/raw/isotop_prop.csv &&
    ###    #silent $statistical_test['isotopologue_proportions']=str($data_input.isotopologue_prop_stat_test)
    ###    #silent $impute_values['isotopologue_proportions']=re.sub('"', '', "min")
    ###    $datatypes_avail.append(re.sub('"', '', "isotopologue_proportions"))
    ####end if

    #if $metadata_path:
        cp '$metadata_path' '${report.extra_files_path}'/raw/metadata.csv &&
    #end if

    #set $conds = list()
    #for $co in $conditions:
        $conds.append(re.sub('"', '', str($co)))
    #end for
    #set $groups = list()
    #for $g in $grouping:
        $groups.append(re.sub('"', '', str($g)))
    #end for
    #set $metabolites = {}
    #for $cp in $compartments:
        #silent $metabolites[re.sub('"', '', str($cp))]=list()
        #for $met in $data_input.metabolites_list:
            $metabolites[re.sub('"', '', str($cp))].append(re.sub('"', '\'', str($met)))
        #end for
    #end for
    #set $timepoints = list()
    #for $tp in $timepoint:
        $timepoints.append(re.sub('"', '', str($tp)))
    #end for


    #set $comparisons = list()
    #for $tp in $timepoint:
        #set $ctrl_found=False
        #set $ctrl=""

        #for $co in $conditions:
            #set $sub_comparisons = list()
            #if str($co) in ["Control", "control","ctrl"]:
                 #set $ctrl_found=True
                 #set $ctrl=str($co)
                 $sub_comparisons.append(re.sub('"', '', str($co)))
                 $sub_comparisons.append(re.sub('"', '', str($tp)))
            #else:
                $sub_comparisons.append(re.sub('"', '', str($co)))
                $sub_comparisons.append(re.sub('"', '', str($tp)))

            #end if
            $comparisons.append($sub_comparisons)
        #end for

        ###if $ctrl_found:
        ###    $sub_comparisons.append(str($ctrl))
        ###    $sub_comparisons.append(str($tp))
        ###    $comparisons.append($sub_comparisons)
        ####end if
    #end for

    HYDRA_FULL_ERROR=1 python -m dimet
        -cd '${report.extra_files_path}'/config
        -cn general_config_diff_multigroup
        '++hydra.run.dir='${report.extra_files_path}'/'${suffix}'-multi_group_comparison'
        '++figure_path=figures'
        '++table_path=tables'
        '+analysis={
             dataset:{
                _target_:data.DatasetConfig,
                name: "Galaxy DIMet run"
            },
            method:{
                _target_: method.MultiGroupComparisonConfig,
                label: multi_group_comparison,
                name: "Multi group statistical comparison using Kruskal-Wallis test",
                datatypes: ${datatypes_avail},
                height_each_stack: ${output_options.height_each_stack},
                x_ticks_text_size: ${output_options.x_ticks_text_size},
                y_ticks_text_size: ${output_options.y_ticks_text_size},
                as_grid: ${output_options.as_grid},
                sharey:${output_options.sharey}
            },
            label: multi_group_comparison,
            datatypes:${datatypes_avail},
            width_each_stack: '${output_options.width_each_stack}',
            inner_numbers_size: '${output_options.inner_numbers_size}'
        }'
        '+analysis.method.qualityDistanceOverSpan='${qualityDistanceOverSpan}''
        '+analysis.timepoints=${timepoints}'
        '+analysis.metabolites=${metabolites}'
        '+analysis.conditions=${comparisons}'
        '+analysis.dataset.label='${suffix}''
        '+analysis.statistical_test=${statistical_test}'
        '+analysis.method.correction_method=${correction_method}'
        '+analysis.method.impute_values=${impute_values}'
        '+analysis.dataset.subfolder='${report.extra_files_path}''
        '+analysis.method.grouping=${groups}'
        '+analysis.dataset.conditions=${conds}'
         #if $metadata_path:
             '+analysis.dataset.metadata=metadata'
         #end if
        #if str( $data_input.data_input_selector ) == "abundance":
            #if $data_input.abundance_file:
                '+analysis.dataset.abundances=abundance'
            #end if
        #elif str( $data_input.data_input_selector ) == "mean_enrichment":
            #if $data_input.me_or_frac_contrib_file:
                '+analysis.dataset.mean_enrichment=me_or_frac_contrib'
            #end if
        #elif str( $data_input.data_input_selector ) == "isotop_prop":
            #if $data_input.isotop_prop_file:
                '+analysis.dataset.isotopologue_proportions=isotop_prop'
            #end if
        #else
            #if $data_input.isotop_abs_file:
                '+analysis.dataset.isotopologues=isotop_abs'
            #end if
        #end if

    && cp '${report.extra_files_path}'/'${suffix}'-multi_group_comparison/tables/*.tsv ./.
    && rm -r '${report.extra_files_path}'/raw
    && rm -r '${report.extra_files_path}'/config


    ]]></command>
    <inputs>
        <conditional name="data_input">
            <param name="data_input_selector" type="select" label="Abundance or Enrichment file" help="Select between raw abundance and mean enrichment files">
                <option value="abundance" selected="True">abundance</option>
                <option value="mean_enrichment">mean_enrichment</option>
                <option value="isotop_prop">isotop_prop</option>
                <option value="isotop_abs">isotop_abs</option>
            </param>
            <when value="abundance">
                <param name="abundance_file" type="data" format="tabular" label="Metabolite abundance file"/>
                <param name="metabolites_list" type="select" optional="false" multiple="true"
                       label="Select Metabolite(s) for factor 1 to plot (2 Max.). You have to load a abundance file prior to have acccess to metabolite list">
                    <validator type="length" min="1" message="Please enter at max 2 compartments"/>
                    <options from_dataset="abundance_file">
                        <column name="metabolite_or_isotopologue" index="0"/>
                        <column name="value" index="0"/>
                        <filter type="unique_value" name="metabolite_or_isotopologue" column="0"/>
                        <filter type="remove_value" value="metabolite_or_isotopologue"/>
                        <!--                <filter type="sort_by" name="timepoint" column="1"/>-->
                    </options>
                    <sanitizer>
                        <valid initial="default">
                            <add preset="string.printable"/>
                            <add value="\t"/>
                            <remove value="&quot;"/>
                            <remove value="&apos;"/>
                        </valid>
                    </sanitizer>
                </param>
                <param name="abundance_stat_test" type="select" value="Tt" display="radio" label="Select statistical to apply to abundance file" help="Please enter at max 1 statistical test by file">
                    <option value="Tt">t-test</option>
                    <option value="MW">Mann Whitney</option>
                    <option value="KW">Kruskall Wallis</option>
                    <option value="ranksum">Wilcoxon's rank sum test</option>
                    <option value="Wcox">Wilcoxon signed-rank test</option>
                    <option value="BrMu">Brunner-Munzel test</option>
                    <option value="prm-scipy">permutations test</option>
                    <option value="disfit">distribution fitting (of the z-score of the ratios), disfit needs several hundreds of metabolites to be trustful.</option>
                </param>
            </when>
            <when value="mean_enrichment">
                <param name="me_or_frac_contrib_file" type="data" format="tabular" label="Mean enrichment or fraction contribution file"/>
                <param name="metabolites_list" type="select" optional="false" multiple="true"
                       label="Select Metabolite(s) for factor 1 to plot (2 Max.). You have to load a abundance file prior to have acccess to metabolite list">
                    <validator type="length" min="1" message="Please enter at max 2 compartments"/>
                    <options from_dataset="me_or_frac_contrib_file">
                        <column name="metabolite_or_isotopologue" index="0"/>
                        <column name="value" index="0"/>
                        <filter type="unique_value" name="metabolite_or_isotopologue" column="0"/>
                        <filter type="remove_value" value="metabolite_or_isotopologue"/>
                        <!--                <filter type="sort_by" name="timepoint" column="1"/>-->
                    </options>
                    <sanitizer>
                        <valid initial="default">
                            <add preset="string.printable"/>
                            <add value="\t"/>
                            <remove value="&quot;"/>
                            <remove value="&apos;"/>
                        </valid>
                    </sanitizer>
                </param>
                <param name="meanE_or_fracContrib_stat_test" type="select" value="Tt"  display="radio" label="Select statistical to apply" help="Please enter at max 1 statistical test by file">
                    <option value="Tt">t-test</option>
                    <option value="MW">Mann Whitney</option>
                    <option value="KW">Kruskall Wallis</option>
                    <option value="ranksum">Wilcoxon's rank sum test</option>
                    <option value="Wcox">Wilcoxon signed-rank test</option>
                    <option value="BrMu">Brunner-Munzel test</option>
                    <option value="prm-scipy">permutations test</option>
                    <option value="disfit">distribution fitting (of the z-score of the ratios), disfit needs several hundreds of metabolites to be trustful.</option>
                </param>
            </when>
            <when value="isotop_prop">
                <param name="isotop_prop_file" type="data" format="tabular" label="Isotopologues proportion abundance file"/>
                <param name="metabolites_list" type="select" optional="false" multiple="true"
                       label="Select Metabolite(s) for factor 1 to plot (2 Max.). You have to load a abundance file prior to have acccess to metabolite list">
                    <validator type="length" min="1" message="Please enter at max 2 compartments"/>
                    <options from_dataset="isotop_prop_file">
                        <column name="metabolite_or_isotopologue" index="0"/>
                        <column name="value" index="0"/>
                        <filter type="unique_value" name="metabolite_or_isotopologue" column="0"/>
                        <filter type="remove_value" value="metabolite_or_isotopologue"/>
                        <!--                <filter type="sort_by" name="timepoint" column="1"/>-->
                    </options>
                    <sanitizer>
                        <valid initial="default">
                            <add preset="string.printable"/>
                            <add value="\t"/>
                            <remove value="&quot;"/>
                            <remove value="&apos;"/>
                        </valid>
                    </sanitizer>
                </param>
                <param name="isotopologue_prop_stat_test" type="select" value="Tt" display="radio" label="Select statistical to apply" help="Please enter at max 1 statistical test by file">
                    <option value="Tt">t-test</option>
                    <option value="MW">Mann Whitney</option>
                    <option value="KW">Kruskall Wallis</option>
                    <option value="ranksum">Wilcoxon's rank sum test</option>
                    <option value="Wcox">Wilcoxon signed-rank test</option>
                    <option value="BrMu">Brunner-Munzel test</option>
                    <option value="prm-scipy">permutations test</option>
                    <option value="disfit">distribution fitting (of the z-score of the ratios), disfit needs several hundreds of metabolites to be trustful.</option>
                </param>
            </when>
            <when value="isotop_abs">
                <param name="isotop_abs_file" type="data" format="tabular" label="Isotopologues absolute abundance file"/>
                <param name="metabolites_list" type="select" optional="false" multiple="true"
                       label="Select Metabolite(s) for factor 1 to plot (2 Max.). You have to load a isotopologues file prior to have acccess to metabolite list">
                    <validator type="length" min="1" message="Please enter at max 2 compartments"/>
                    <options from_dataset="isotop_abs_file">
                        <column name="metabolite_or_isotopologue" index="0"/>
                        <column name="value" index="0"/>
                        <filter type="unique_value" name="metabolite_or_isotopologue" column="0"/>
                        <filter type="remove_value" value="metabolite_or_isotopologue"/>
                        <!--                <filter type="sort_by" name="timepoint" column="1"/>-->
                    </options>
                    <sanitizer>
                        <valid initial="default">
                            <add preset="string.printable"/>
                            <add value="\t"/>
                            <remove value="&quot;"/>
                            <remove value="&apos;"/>
                        </valid>
                    </sanitizer>
                </param>
                <param name="isotopologue_abs_stat_test" type="select" value="Tt" display="radio" label="Select statistical to apply" help="Please enter at max 1 statistical test by file">
                    <option value="Tt">t-test</option>
                    <option value="MW">Mann Whitney</option>
                    <option value="KW">Kruskall Wallis</option>
                    <option value="ranksum">Wilcoxon's rank sum test</option>
                    <option value="Wcox">Wilcoxon signed-rank test</option>
                    <option value="BrMu">Brunner-Munzel test</option>
                    <option value="prm-scipy">permutations test</option>
                    <option value="disfit">distribution fitting (of the z-score of the ratios), disfit needs several hundreds of metabolites to be trustful.</option>
                </param>
            </when>
        </conditional>
<!--        <param name="abundance_file" type="data" format="tabular" label="Metabolite abundance file"/>-->
<!--        <param name="me_or_frac_contrib_file" type="data" optional="true" format="tabular" label="Mean enrichment or fraction contribution file"/>-->
        <param name="metadata_path" type="data" format="tabular" label="metadata file"/>
        <param name="suffix" type="text" optional="false" label="suffix to add to output files" >
            <sanitizer invalid_char="">
                <valid initial="string.ascii_letters,string.digits">
                    <add value="_" />
                </valid>
            </sanitizer>
        </param>
        <param name="correction_method" type="select" value="bonferroni" display="radio" label="Select multiple test correction to apply" help="Please enter at max 1 method">
                <option value="bonferroni">bonferroni</option>
                <option value="holm-sidak">holm-sidak</option>
                <option value="holm">holm</option>
                <option value="simes-hochberg">simes-hochberg</option>
                <option value="hommel">hommel</option>
                <option value="fdr_bh">fdr_bh</option>
                <option value="fdr_by">fdr_by</option>
                <option value="fdr_tsbh">fdr_tsbh</option>
                <option value="fdr_tsbky">fdr_tsbky</option>
        </param>
        <param name="conditions" type="select" optional="false" multiple="true"
               label="Browse conditions from metadata file. You have to load a metadata file prior to have acccess to metabolite list">
            <options from_dataset="metadata_path">
                <column name="condition" index="1"/>
                <column name="value" index="1"/>
                <filter type="unique_value" name="condition" column="condition"/>
                <filter type="remove_value" value="condition"/>
                <!--                <filter type="sort_by" name="timepoint" column="1"/>-->
            </options>
            <sanitizer>
                <valid initial="default">
                    <add preset="string.printable"/>
                    <add value="\t"/>
                    <remove value="&quot;"/>
                    <remove value="&apos;"/>
                </valid>
            </sanitizer>
        </param>
        <param name="timepoint" type="select" optional="false" multiple="true"
               label="Browse timepoint from metadata file (2 Max.). You have to load a metadata file prior to have acccess to metabolite list">
            <options from_dataset="metadata_path">
                <column name="timepoint" index="2"/>
                <column name="value" index="2"/>
                <filter type="unique_value" name="timepoint" column="2"/>
                <filter type="remove_value" value="timepoint"/>
                <!--                <filter type="sort_by" name="timepoint" column="1"/>-->
            </options>
            <sanitizer>
                <valid initial="default">
                    <add preset="string.printable"/>
                    <add value="\t"/>
                    <remove value="&quot;"/>
                    <remove value="&apos;"/>
                </valid>
            </sanitizer>
        </param>
        <param name="compartments" type="select" optional="false" multiple="true"
               label="Browse compartments from metadata file (2 Max.). You have to load a metadata file prior to have acccess to metabolite list">
<!--            <validator type="length" min="1" message="Please enter at min 1 compartments"/>-->
            <options from_dataset="metadata_path" >
                <column name="short_comp" index="4"/>
                <column name="value" index="4"/>
                <filter type="unique_value" name="short_comp" column="4"/>
                <filter type="remove_value" value="short_comp"/>
                <!--                <filter type="sort_by" name="timepoint" column="1"/>-->
            </options>
            <sanitizer>
                <valid initial="default">
                    <add preset="string.printable"/>
                    <add value="\t"/>
                    <remove value="&quot;"/>
                    <remove value="&apos;"/>
                </valid>
            </sanitizer>
        </param>
        <param name="qualityDistanceOverSpan" type="float" min="-1.0" max="-0.1" value="-0.3" label="quality Distance Over Span" help="Default value is -0.3."/>
        <param name="grouping" type="select"  optional="false" multiple="true" label="Select group to compare">
            <option value="condition" selected="true">condition</option>
            <option value="timepoint">timepoint</option>
        </param>
        <section name="output_options" title="Output options">
            <param name="as_grid" type="boolean" value="false" label="plot as grid"
                   help="Default value is false."/>
            <param name="sharey" type="boolean" value="false" label="share y axis"
                   help="Default value is false."/>
            <param name="axisx_labeltilt" type="integer" min="0" max="180" value="90" label="X axis label tilt"
                   help="Default value is 90."/>
            <param name="x_ticks_text_size" type="integer" min="1" max="24" value="18" label="xticks text size"
                   help="Default value is 18."/>
            <param name="y_ticks_text_size" type="integer" min="1" max="24" value="18" label="yticks text size"
                   help="Default value is 18."/>
            <param name="width_each_subfig" type="float" min="1.0" max="15.0" value="3.0" label="width of subfig plots"
                   help="Default value is 3."/>
            <param name="wspace_subfigs" type="float" min="0.0" max="1.0" value="1.0" label="wspace between subfigs"
                   help="Default value is 1."/>
            <param name="height_each_stack" type="float" min="1.0" max="10.0" value="4.6" label="height of each stack"
                   help="Default value is 4.6."/>
            <param name="width_each_stack" type="float" min="0.1" max="5.0" value="3.0" label="width of each stack"
                   help="Default value is 3.0."/>
            <param name="height_each_subfig" type="float" min="1.0" max="15.0" value="3.0" label="height of subfig plots"
                   help="Default value is 3."/>
            <param name="inner_numbers_size" type="integer" min="1" max="20" value="13" label="inner number size"
                   help="Default value is 13."/>
            <param name="max_nb_carbons_possible" type="integer" min="1" max="20" value="12" label="max number carbons possible"
                   help="Default value is 12."/>
        </section>
    </inputs>

    <outputs>
        <data name="report" format="html">
            <discover_datasets pattern="__designation_and_ext__" directory="." visible="true"/>
        </data>
    </outputs>
    <tests>
        <test>
            <param name="data_input_selector" value="abundance" />
            <param name="abundance_file" ftype="tabular" value="rawAbundances3.csv"/>
            <param name="metadata_path" ftype="tabular" value="example3_metadata.csv"/>
            <param name="abundance_stat_test" value="prm-scipy"/>
            <param name="suffix" value="toy1a001"/>
            <param name="conditions" value="Control,Cond1,Cond2"/>
            <param name="timepoint" value="T0h,T2h"/>
            <param name="grouping" value="condition,timepoint"/>
            <param name="compartments" value="cell"/>
            <param name="metabolites_list" value="Glycine,Hexose,L-Tryptophan"/>
            <section name="output_options">
                <param name="width_each_stack" value="3.0"/>
                <param name="max_nb_carbons_possible" value="12"/>
            </section>
            <output name="report" file="report.html" count="3"/>
        </test>
    </tests>
    <help><![CDATA[
    dimet @EXECUTABLE@

**Input data files**

This tool computes the Kruskall Wallis test over 3 or more groups, to evaluate if at least one group is significantly different to the other groups (H0: median of all of the groups is equal). For illustration see the section **Metadata File Information** which contains three conditions: Control, Core_mass and Edge_tissue, across one single time point, thus 3 groups (number-of-groups-in-my-data = number-of-conditions x number-of-timepoints)).

This tool requires (at max.) 5 tab-delimited .cvs files as inputs. There are two types of files:

- The measures' (or quantifications') files, that can be of 4 types.

- The metadata, a unique file with the description of the samples in your measures' files. This is compulsory.

For running DIMet @EXECUTABLE@ you need **at least one** file of measures:

- The total **abundances** (of the metabolites) file

- The mean **enrichment** or labelled fractional contributions

- The **isotopologues** absolute values files (optional)

- The **isotopologue proportions** file (optional)

and one metadata file, WHICH IS COMPULSORY, see section **Metadata File Information**.

The measure's files must be organized as matrices:

- The first column must contain Metabolite IDs that are unique (not repeated) within the file.

- The rest of the columns correspond to the samples

- The rows correspond to the metabolites

- The values must be tab separated, with the first row containing the sample/column labels.

See the following examples of measures' files:

Example - Metabolites **abundances**:

    =============== ================== ================== ================== ================== ================== ==================
    ID              **MCF001089_TD01** **MCF001089_TD02** **MCF001089_TD03** **MCF001089_TD04** **MCF001089_TD05** **MCF001089_TD06**
    =============== ================== ================== ================== ================== ================== ==================
    2_3-PG          8698823.9926       10718737.7217      10724373.9         8536484.5          22060650           28898956
    2-OHGLu         36924336           424336             92060650           45165              84951950           965165051
    Glc6P           2310               2142               2683               1683               012532068          1252172
    Gly3P           399298             991656565          525195             6365231            89451625           4952651963
    IsoCit          0                  0                  0                  84915613           856236             954651610
    =============== ================== ================== ================== ================== ================== ==================

Example - mean **enrichment** or labeled fractional contributions:

    =============== ================== ================== ================== ================== ================== ==================
    ID              **MCF001089_TD01** **MCF001089_TD02** **MCF001089_TD03** **MCF001089_TD04** **MCF001089_TD05** **MCF001089_TD06**
    =============== ================== ================== ================== ================== ================== ==================
    2_3-PG          0.9711             0.968              0.9909             0.991              0.40               0.9
    2-OHGLu         0.01719            0.0246             0.554              0.555              0.73               0.68
    Glc6P           0.06               0.66               2683               0.06               2068               2172
    Gly3P           0.06               0.06               0.06               1                  5                  3
    IsoCit          0.06               1                  0.49               0.36               6                  10
    =============== ================== ================== ================== ================== ================== ==================

Example - **Isotopologues**

    =============== ================== ================== ================== ================== ================== ==================
    ID              **MCF001089_TD01** **MCF001089_TD02** **MCF001089_TD03** **MCF001089_TD04** **MCF001089_TD05** **MCF001089_TD06**
    =============== ================== ================== ================== ================== ================== ==================
    2_3-PG_m+0      206171.4626        285834.0353        36413.27637        27367.17784        6171.4626          119999
    2_3-PG_m+1      123                432                101                127                206171.4626        119999
    2_3-PG_m+2      133780.182         161461.2364        182631.3947        132170.3807        358749.348         848754.36
    2_3-PG_m+3      8358749.348        10271010.45        10505228.3         8376820.028        62163.30727        1088.8963
    2-OHGLu_m+0     5550339.322        6072872.833        3855047.791        3216178.72         8358749.348        10271010.45
    2-OHGLu_m+1     0.0                0.0                0.0                0.0                206171.4626        285834.0353
    =============== ================== ================== ================== ================== ================== ==================

Example - **Isotopologue proportions**:

    =============== ================== ================== ================== ================== ================== ==================
    ID              **MCF001089_TD01** **MCF001089_TD02** **MCF001089_TD03** **MCF001089_TD04** **MCF001089_TD05** **MCF001089_TD06**
    =============== ================== ================== ================== ================== ================== ==================
    2_3-PG_m+0      0.023701408        0.026667837        0.003395407        0.05955            0.034383527        0.12
    2_3-PG_m+1      0.0                0.0                0.0                0.0                0.4                0.12
    2_3-PG_m+2      0.015379329        0.01506            0.017029723        0.35483229         0.54131313         0.743
    2_3-PG_m+3      0.960919263        0.958268099        0.97957487         0.581310816        0.017029723        0.017
    2-OHGLu_m+0     0.972778716        0.960016157        0.238843937        0.234383527        0.9998888          0.015064063
    2-OHGLu_m+1     0.0                0.0                0.0                0.0                0.0001112          0.960919263
    =============== ================== ================== ================== ================== ================== ==================

**Metadata File Information**

Provide a tab-separated file that has the names of the samples in the first column and one header row.

Column names must be exactly in this order:
   name_to_plot
   condition
   timepoint
   timenum
   short_comp
   original_name

Example **Metadata File**:

    ==================== =============== ============= ============ ================ =================
    **name_to_plot**     **condition**   **timepoint** **timenum**  **short_comp**   **original_name**
    -------------------- --------------- ------------- ------------ ---------------- -----------------
    Control_cell-1        Control         T0            0            cell             MCF001089_TD01
    Control_cell-2        Control         T0            0            cell             MCF001089_TD02
    Control_cell-3        Control         T0            0            cell             MCF001089_TD03
    CoreMass_cell-1       Core_mass       T0            0            cell             MCF001089_TD04
    CoreMass_cell-2       Core_mass       T0            0            cell             MCF001089_TD05
    CoreMass_cell-3       Core_mass       T0            0            cell             MCF001089_TD06
    EdgeTiss_cell-1       Edge_tissue     T0            0            cell             MCF001089_TD07
    EdgeTiss_cell-2       Edge_tissue     T0            0            cell             MCF001089_TD08
    EdgeTiss_cell-3       Edge_tissue     T0            0            cell             MCF001089_TD09
    ==================== =============== ============= ============ ================ =================

The column **original_name** must have the names of the samples as given in your data.

The column **name_to_plot** must have the names as you want them to be (or set identical to original_name if you prefer). To set names that are meaningful is a better choice, as we will take them to display the results.

The column **timenum** must contain only the numeric part of the timepoint, for example 2,0, 10, 100 (this means, without letters ("T", "t", "s", "h" etc) nor any other symbol). Make sure these time numbers are in the same units (but do not write the units here!).

The column **short_comp** is an abbreviation, coined by you, for the compartments. This will be used for the results' files names: the longer the compartments names are, the longer the output files' names! Please pick short and clear abbreviations to fill this column.

**Running the analysis**

You can precise how you want your analysis to be executed, with the parameters:

- **comparisons** : the groups you want to select for comparison in the multigroup analysis

(Note that **comparisons** parameter in the multigroup analysis does not have the same usage as in the pairwise differential analysis).

- **datatypes** : the measures type(s) that you want to run


- **correction_method** : one of the methods for multiple testinc correction available in statsmodels library (bonferroni, fdr_bh, sidak, among others, see https://www.statsmodels.org/dev/generated/statsmodels.stats.multitest.multipletests.html).


There exist hints on use that will guide you, next to the parameters.


 ]]>
    </help>
    <expand macro="citations"/>
</tool>