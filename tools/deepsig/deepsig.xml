<?xml version="1.0"?>
<tool id="deepsig" name="deepsig" version="@TOOL_VERSION@+galaxy0" profile="21.05">
    <description>Predictor of signal peptides in proteins</description>
    <macros>
        <import>macros.xml</import>
    </macros>
    <requirements>
        <requirement type="package" version="@TOOL_VERSION@">deepsig</requirement>
    </requirements>

    

    <command detect_errors="exit_code"><![CDATA[
        deepsig
        -f '$input'
        -o '$output'
        -k '$organism'
        -m '$output_format'
    ]]>
    </command>

    <inputs>
        <param name="input_fasta" argument="-f" type="data" format="fasta" label="FASTA sequence"/>
        <param name="output" argument="-o" type="data" format="outf" label="Output tabular file"/>
        <param name="organism" argument="-k" type="select" label="Organism" help="Select a organism between euk for Eukaryotes, gramp for Gram-positive bacteria or gramn for Gram-negative bacteria ">
            <option value="euk" selected="true">euk</option>
            <option value="gramp">gramp</option>
            <option value="gramn">gramn</option>
        </param>
        <param name="output_format" argument="-m" type="select" label="output_format" help="Select a output file between gff3 (default) and json ">
            <option value="gff3" selected="true">GFF3</option>
            <option value="json">JSON</option>

        </param>
    </inputs>

    <outputs>
        <data name="output" format="outf" label="DeepSig on ${on_string}"></data>
    </outputs>

    <tests>
        <test expect_num_outputs="1">
            <param name="input_fasta" value="G5ED35.fasta" ftype="fasta" />
            <param name="organism" value="euk"/>
            <param name="output_format" ftype="outf" value="gff3"/>
            <output name="output" ftype="outf">
                <assert_contents>
                    <has_text text="sp|G5ED35|TTR52_CAEEL" />
                    <has_text text="evidence=ECO:0000256" />
                </assert_contents>
            </output>
        </test>
        <test expect_num_outputs="1">
            <param name="input_fasta" value="G5ED35.fasta" ftype="fasta" />
            <param name="organism" value="euk"/>
            <param name="output_format" ftype="outf" value="json"/>
            <output name="output" ftype="outf">
                <assert_contents>
                    <has_text text="sp|G5ED35|TTR52_CAEEL" />
                    <has_text text="evidence=ECO:0000256" />
                    <has_text text='"sequence": "MSRFLIYFLPFFIYSGNVLSKTSCLMATGVLKCPTDPEAVKKVHIDLWDEDSLPLESDDLMGRTWSDRNGNFQVTGCASDFGPINTPDPYLYIQHNCPHRDSNATNPIQIDVIPLFLPSIVRLGNVYLDRYLEDY"' />
                </assert_contents>
            </output>
        </test>
    </tests>

    <help><![CDATA[
        deepsig_  Predictor of signal peptides in proteins based on deep learning.
        DeepSig is a novel approach to predict signal peptides in proteins based on 
        deep learning and sequence labelling methods. The proposed approach was 
        evaluated and compared with other available predictors, including the top-performing SignalP.

        .. _deepsig: https://github.com/BolognaBiocomp/deepsig
    ]]></help>

    <citations>
        <citation type="bibtex"><![CDATA[
            @article{10.1093/bioinformatics/btx818,
                author = {Savojardo, Castrense and Martelli, Pier Luigi and Fariselli, Piero and Casadio, Rita},
                title = "{DeepSig: deep learning improves signal peptide detection in proteins}",
                journal = {Bioinformatics},
                volume = {34},
                number = {10},
                pages = {1690-1696},
                year = {2017},
                month = {12},
                abstract = "{The identification of signal peptides in protein sequences is an important step toward protein localization and function characterization.Here, we present DeepSig, an improved approach for signal peptide detection and cleavage-site prediction based on deep learning methods. Comparative benchmarks performed on an updated independent dataset of proteins show that DeepSig is the current best performing method, scoring better than other available state-of-the-art approaches on both signal peptide detection and precise cleavage-site identification.DeepSig is available as both standalone program and web server at https://deepsig.biocomp.unibo.it. All datasets used in this study can be obtained from the same website.Supplementary data are available at Bioinformatics online.}",
                issn = {1367-4803},
                doi = {10.1093/bioinformatics/btx818},
                url = {https://doi.org/10.1093/bioinformatics/btx818},
                eprint = {https://academic.oup.com/bioinformatics/article-pdf/34/10/1690/48935698/bioinformatics\_34\_10\_1690.pdf},
            }                 
        ]]>
        </citation>
    </citations>
</tool>