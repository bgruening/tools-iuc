<tool id="data_manager_ncbi_fcs_gx_database_downloader" name="NCBI FCS GX database downloader" version="@TOOL_VERSION@+galaxy@VERSION_SUFFIX@" python_template_version="3.5" tool_type="manage_data" profile="@PROFILE@">
    <description>Downoad the NCBI FCS GX database</description>
    <macros>
        <import>macros.xml</import>
    </macros>
    <command detect_errors="exit_code"><![CDATA[
python '$__tool_directory__/data_manager_ncbi_fcs_gx_database_downloader.py'
--context '${context.context_selector}'
--mode '${context.mode.mode_selector}'
#if $context.context_selector == 'configure'
    #if $varExists('context.mode.tag')
    --tag '${context.mode.tag}'
    #else
    --tag '${context.mode.database}'
    #end if

    #if $context.mode_selector in ('add', 'update')
    --description '${context.mode.description}'
    --default '${context.mode.default}'
    --phone_home '${context.mode.phone_home}'
    --manifest '${context.mode.manifest}'
    --local_cache_dir '${context.mode.local_cache_dir}'
    --tool_cache_dir '${context.mode.tool_cache_dir}'
    #end if
#else if $context.context_selector == 'manage'
    --tag '${context.mode.database}'
#end if
--output_file '${output_file}'
    ]]></command>
    <inputs>
        <conditional name="context">
            <param name="context_selector" type="select" label="Choose to configure or manage databases">
                <option value="configure" selected="true">Configure available databases</option>
                <option value="manage">Download/remove databases</option>
            </param>
            <when value="configure">
                <conditional name="mode">
                    <param name="mode_selector" type="select" label="Add / Update / Delete">
                        <option value="add">Add database config entry</option>
                        <option value="update">Update database config entry</option>
                        <option value="remove">Delete database config entry</option>
                    </param>
                    <when value="add">
                        <param name="tag" type="text" label="Unique identifier for database" /> 
                        <param name="description" type="text" label="Enter the database description" /> 
                        <param name="default" type="boolean" checked="false"  label="Make this the default entry" /> 
                        <param name="phone_home" type="boolean" checked="false"  label="Phone home" /> 
                        <param name="manifest" type="text" label="Manifest" />
                        <param name="local_cache_dir" type="text" label="Local Cache Dir" />
                        <param name="tool_cache_dir" type="text" label="Tool Cache Dir" />
                    </when>
                    <when value="update">
                        <param name="database" type="select" label="Select the database config entry to update">
                            <options from_data_table="ncbi_fcs_gx_databases" />
                            <validator type="no_options" message="No databases are available" />
                        </param>
                        <param name="description" type="text" label="Enter the database description" /> 
                        <param name="default" type="boolean" checked="false"  label="Make this the default entry" /> 
                        <param name="phone_home" type="boolean" checked="false"  label="Phone home" /> 
                        <param name="manifest" type="text" label="Manifest" />
                        <param name="local_cache_dir" type="text" label="Local Cache Dir" />
                        <param name="tool_cache_dir" type="text" label="Tool Cache Dir" />
                    </when>
                    <when value="remove">
                        <param name="database" type="select" label="Select the database config entry to remove">
                            <options from_data_table="ncbi_fcs_gx_databases" />
                            <validator type="no_options" message="No databases are available" />
                        </param>
                    </when>
                </conditional>
            </when>
            <when value="manage">
                <conditional name="mode">
                    <param name="mode_selector" type="select" label="Download / Delete">
                        <option value="download" selected="true">Download database</option>
                        <option value="delete">Delete database</option>
                    </param>
                    <when value="download">
                        <param name="database" type="select" label="Select the database to download">
                            <options from_data_table="ncbi_fcs_gx_databases" />
                            <validator type="no_options" message="No databases are available" />
                        </param>
                    </when>
                    <when value="delete">
                        <param name="database" type="select" label="Select the database to delete">
                            <options from_data_table="ncbi_fcs_gx_databases" />
                            <validator type="no_options" message="No databases are available" />
                        </param>
                    </when>
                </conditional>
            </when>
        </conditional>
    </inputs>
    <outputs>
        <data name="output_file" format="data_manager_json" />
    </outputs>
    <help><![CDATA[
    ]]></help>
    <expand macro="citations" />
</tool>
